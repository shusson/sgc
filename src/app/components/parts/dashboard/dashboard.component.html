<div class="loading-message" *ngIf="loading && !error">
    <mat-spinner color="primary"></mat-spinner>
</div>
<div class="search-jumbo" *ngIf="!error">
    <app-search-bar-with-options
        [expandable]="true"
        [action]="addGeneOrRegion"
        example1="BRCA1"
        example2="TTN"></app-search-bar-with-options>
</div>

<section>
    <div class="message message-error search" *ngIf="searchError"><mat-icon>error_outline</mat-icon> {{ searchError }}. Please Try again</div>
    <div class="message message-error" *ngIf="error"><mat-icon>error_outline</mat-icon> {{ error }}</div>
    <div class="message message-info" *ngIf="subtotal <=0 && !error && !loading"><mat-icon>info_outline</mat-icon> No variants found for your query. Please widen your search.</div>
    <div *ngIf="!error && subtotal > 0">
        <div class="message message-warning">
            <mat-icon>help_outline</mat-icon>
            <div>While in Beta please treat data with caution and any <a (click)="openFeedback()">feedback</a> is
                appreciated
            </div>
        </div>
        <div class="results">
            <div class="charts-toolbar" *ngIf="cf.x">
                <div class="icons">
                    <mat-icon class="material-icons" (click)="clearFilters()" matTooltip="Clear All Filters"
                             matTooltipPosition="above">refresh
                    </mat-icon>
                    <mat-icon [matMenuTriggerFor]="dashBoardSettings" matTooltip="Dashboard Settings" class="material-icons">
                        settings
                    </mat-icon>
                </div>

                <div class="count">
                    <mat-chip selected="true" color="accent" matTooltip="Filtered number of Variants"
                             matTooltipPosition="above">
                        {{ subtotal }}
                    </mat-chip>
                    /
                    <mat-chip selected="true" color="accent" matTooltip="Total number of Variants"
                             matTooltipPosition="above">
                        {{ total }}
                    </mat-chip>
                </div>
            </div>
            <div *ngIf="showSql" class="generated-sql">
                <div>{{ sql }}</div>
                <div *ngIf="!sql">No Active filters</div>
            </div>

            <div class="charts" *ngIf="dx">
                <div class="main">
                    <div class="right">
                        <div class="row" >
                            <div class="chart" *ngFor="let c of cs.enabledCharts()">
                                <app-mapd-avg-af-chart *ngIf="c.type === chartType.Custom" [filter]="dx"></app-mapd-avg-af-chart>
                                <app-mapd-row-chart *ngIf="c.type === chartType.Row" [chart]="c" [filter]="dx"></app-mapd-row-chart>
                                <app-mapd-pie-chart *ngIf="c.type === chartType.Pie" [chart]="c" [filter]="dx"></app-mapd-pie-chart>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
            <div class="table" *ngIf="cf.x">
                <app-variants-table-paginated></app-variants-table-paginated>
            </div>
        </div>
    </div>

</section>

<mat-menu #dashBoardSettings="matMenu">
    <div mat-menu-item (click)="toggleSql($event)" [matTooltip]="sqlTooltip()" matTooltipPosition="above">
        <mat-slide-toggle
            [checked]="showSql">
            Show Generated SQL Filter
        </mat-slide-toggle>
    </div>
    <button mat-menu-item class="material-icons" (click)="openFeedback()" matTooltipPosition="above">
        Give feedback
    </button>
    <button mat-menu-item [matMenuTriggerFor]="dimensions">Show/Hide Charts</button>
</mat-menu>

<mat-menu class="custom-mat-short-column" #dimensions="matMenu">
    <div mat-menu-item *ngFor="let c of cs.charts" (click)="toggleChart($event, c)">
        <mat-slide-toggle [checked]="c.enabled">{{ c.name }}
        </mat-slide-toggle>
    </div>
</mat-menu>

