<div class="loading-message" *ngIf="loading && !error">
    <mat-spinner color="primary"></mat-spinner>
</div>
<div class="search-jumbo" *ngIf="!error">
    <app-search-bar-with-options [expandable]="true" [action]="addGeneOrRegion" [example1]="'BRCA1'" example2="22:16000000-17000000"></app-search-bar-with-options>
</div>

<section>
    <div class="message message-error search" *ngIf="searchError"><mat-icon>error_outline</mat-icon> {{ searchError }}. Please Try again</div>
    <div class="message message-error" *ngIf="error"><mat-icon>error_outline</mat-icon> {{ error }}</div>
    <div *ngIf="!error">
        <div class="message message-warning">
            <mat-icon>help_outline</mat-icon>
            <div>While in Beta please treat data with caution and any <a (click)="openFeedback()">feedback</a> is
                appreciated
            </div>
        </div>
        <div class="results">
            <div class="charts-toolbar" *ngIf="cf.x">
                <div class="icons">
                    <mat-icon class="material-icons" (click)="clearFilters()" matTooltip="Clear All Filters"
                             matTooltipPosition="above">refresh
                    </mat-icon>
                    <mat-icon class="material-icons" (click)="toggleSql()" [matTooltip]="sqlTooltip()"
                             matTooltipPosition="above">list
                    </mat-icon>
                    <mat-icon class="material-icons" (click)="openFeedback()" matTooltip="Give feedback on the beta"
                             matTooltipPosition="above">feedback
                    </mat-icon>
                    <mat-icon [matMenuTriggerFor]="dimensions" matTooltip="Table Settings" class="material-icons">
                        settings
                    </mat-icon>
                    <!--<mat-icon class="material-icons" (click)="saveFilters()" matTooltip="Save the current filter"-->
                             <!--matTooltipPosition="above">save-->
                    <!--</mat-icon>-->
                    <!--<mat-icon class="material-icons" mat-icon-button [matMenuTriggerFor]="menu" matTooltip="load filters"-->
                             <!--matTooltipPosition="above">folder_open-->
                    <!--</mat-icon>-->
                    <!--<mat-menu #menu="matMenu">-->
                        <!--<button *ngFor="let t of getTags()" (click)="loadFilters(t)" mat-menu-item>-->
                            <!--<span >{{t}}</span>-->
                        <!--</button>-->
                    <!--</mat-menu>-->
                    <!--<mat-icon class="material-icons" (click)="compare()" matTooltip="Compare saved filters"-->
                             <!--matTooltipPosition="above">compare_arrows-->
                    <!--</mat-icon>-->
                </div>

                <div class="count">
                    <mat-chip selected="true" color="accent" matTooltip="Filtered number of Variants"
                             matTooltipPosition="above">
                        {{ subtotal }}
                    </mat-chip>
                    /
                    <mat-chip selected="true" color="accent" matTooltip="Total number of Variants"
                             matTooltipPosition="above">
                        {{ total }}
                    </mat-chip>
                </div>
            </div>
            <div *ngIf="showSql" class="generated-sql">
                <div>{{ cf.sql }}</div>
                <div *ngIf="!cf.sql">No Active filters</div>
            </div>

            <div class="charts" *ngIf="dx">
                <div class="main">
                    <div class="right">
                        <div class="row" >
                            <div class="chart" *ngFor="let c of cs.charts">
                                <app-mapd-avg-af-chart *ngIf="c.type === chartType.Custom" [filter]="dx" [ranges]="ranges"></app-mapd-avg-af-chart>
                                <app-mapd-row-chart *ngIf="c.type === chartType.Row" [chart]="c" [filter]="dx"></app-mapd-row-chart>
                                <app-mapd-pie-chart *ngIf="c.type === chartType.Pie" [chart]="c" [filter]="dx"></app-mapd-pie-chart>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
            <div class="table" *ngIf="cf.x">
                <app-variants-table-paginated></app-variants-table-paginated>
            </div>
        </div>
    </div>

</section>

<mat-menu #dimensions="matMenu">
    <div mat-menu-item *ngFor="let c of cs.charts">
        {{ c.name }}
    </div>
</mat-menu>

